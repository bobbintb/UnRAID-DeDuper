Menu="DiskUtilities"
Title="Dedupe"
Icon="fa-search-minus"
---
<?PHP

?>
<style>
    #main_container {
        --main_container_height: 65vh;
        //border:1px solid black;
        height: var(--main_container_height);
        display: flex;
        flex-direction: row;
        margin-top: -30px;
    }

    .disabled {
        background-color: #ccc !important;
        color: #888 !important;
        cursor: default !important;
        pointer-events: none !important;    }

    .strike-through {
        text-decoration: line-through red;
    }

    #left {
        //border:1px solid red;
        resize: horizontal;
        width: 70%;
        min-width: 20%;
        max-width: 80%;
        overflow: auto;
        //margin-left: 10px;
        margin-right: 5px;
    }


    #left.tabulator {
        font-size: 12px;
    }

    #right {
        //border:1px solid blue;
        flex: 1;
        margin-left: 5px;
        //margin-right: 10px;
    }

    #bottom_container {
        --bottom_container_height: 10vh;
    //border:1px solid black;
        height: var(--bottom_container_height);
        display: flex;
        flex-direction: row;
    }
    #bleft {
        border:1px solid red;
        resize: horizontal;
        overflow: auto;
        width: 70%;
    }

    #bright {
    border:1px solid blue;
        flex: 1;
        margin-left: 5px;
    //margin-right: 10px;
    }
</style>

<script type="text/javascript" src="https://unpkg.com/tabulator-tables@6.2.1/dist/js/tabulator.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/luxon/build/global/luxon.min.js"></script>

<script>
    <?php
    $DBfilename = './plugins/bobbintb.system.dedupe/files.json';

    if (file_exists($DBfilename)) {
        $db = file_get_contents($DBfilename);
        echo "const db = " . $db . ";";
        echo "const tableData = Object.values(db).reduce((acc, val) => acc.concat(val), []);";

    } else {
        echo "const tableData = []);";
    }
    ?>


</script>
<div id="main_container">
        <link href="https://unpkg.com/tabulator-tables@6.2.1/dist/css/tabulator.min.css" rel="stylesheet">
        <div id="left"><?php include './plugins/bobbintb.system.dedupe/php/left.php'; ?></div>
        <div id="right"><?php include './plugins/bobbintb.system.dedupe/php/right.php'; ?></div>

</div>
<div id="bottom_container">
<div id="bleft"></div>
<div id="bright"></div>
</div>