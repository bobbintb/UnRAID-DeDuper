name: Package PLG
on:
  workflow_dispatch:
env:
  SSL_CERT_FILE: "/etc/ssl/certs/ca-certificates.crt"
jobs:
  package_and_update:
    permissions: write-all
    runs-on: ubuntu-latest
    container: bobbintb/auto_slack_pack:latest
    env:
      name: "bobbintb.system.dedupe"
      author: "bobbintb"
      repo: "UnRAID-DeDuper"
      launch: "Settings/Dedupe"
      pluginURL: "https://raw.githubusercontent.com/&author;/&repo;/master/&name;.plg"
      source: "/boot/config/plugins/&name;/&name;"
      icon: "fa-search-minus"
      min: "6.1.9"
      SSL_CERT_FILE: "/etc/ssl/certs/ca-certificates.crt"
    steps:
      - name: delete me later
        run: slackpkg reinstall openssl
      - name: Checkout repository
        uses: actions/checkout@v4
      - name: Download UnRAID-Plugin-Generator
        run: |
          wget https://raw.githubusercontent.com/bobbintb/UnRAID-Plugin-Generator/main/plugin.sh
          chmod +x plugin.sh
      - name: Run UnRAID-Plugin-Generator
        run: |
          ./plugin.sh
          rm plugin.sh
          ls -ls
